#!/usr/bin/env bash
# Configures a new Ubuntu server to serve a custom HTTP header using Nginx

# Install nginx if not already installed
apt-get update
apt-get install -y nginx

# Get the hostname of the server
hostname=$(hostname)

# Add the custom header to the default Nginx config
config_file="/etc/nginx/sites-available/default"

# Add the header line only if it doesn't already exist
if ! grep -q "add_header X-Served-By" "$config_file"; then
    sed -i "/server_name _;/a \\tadd_header X-Served-By \$hostname;" "$config_file"
fi

# Reload nginx to apply changes
systemctl restart nginx
